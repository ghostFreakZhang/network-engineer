


# 操作系统

- [操作系统](#操作系统)
  - [整体情况](#整体情况)
  - [操作系统概述 ⭐](#操作系统概述-)
  - [进程管理 ⭐⭐⭐](#进程管理-)
  - [存储管理 ⭐](#存储管理-)
  - [文件管理 ⭐⭐](#文件管理-)
  - [作业管理 ⭐](#作业管理-)
  - [设备管理 ⭐⭐](#设备管理-)

## 整体情况

考试占比不高。

## 操作系统概述 ⭐
计算机软件分为系统软件和应用软件。

系统软件包括操作系统、程序设计语言、数据库系统。

程序设计语言：
- 机器语言，二进制代码，低级语言
- 汇编语言，低级语言
- 高级语言，不可直接被计算机识别
  - 编译程序，有目标程序生成
  - 翻译程序，无目标程序生成
- 4GL语言

## 进程管理 ⭐⭐⭐
程序是静态的，进程是动态的。

进程的状态：
- 运行
- 就绪
- 等待

**死锁问题**：

如果一个进程在等待一个不可能发生的事，进程就死锁了；

如果一个或多个进程产生死锁，就会造成系统死锁。

产生死锁的四个必要条件：
- 互斥条件，所占有的资源是互斥的
- 保持和等待条件，保持着一个资源，同时等待别的资源
- 不可剥夺条件，除非自己主动释放，资源不能被剥夺
- 环路等待，等待状态形成环路

产生死锁原因：
- 系统资源数量是有限
- 申请资源时没有合理的顺序

m 个并发进程每个都需要 n 个资源 R，使得系统不发生死锁的资源 R 的最少数目为 m x (n - 1) + 1

解决死锁：
- 死锁预防：限制多，开销大，用的很少
- 死锁避免：银行家算法避免死锁
- 死锁检测
- 死锁解除：撤销进程法和资源剥夺法

**银行家算法**

分配资源原则：
- 一个进程最大资源需求量不超过系统的资源数时可接纳
- 进程可分期请求资源，但请求总数不能超过最大需求量
- 现有资源不能满足进程需要时，对进程请求可推迟分配，但总能使进程在有限时间内得到资源

**进程的互斥和同步**

互斥：如千军万马过独木桥，需要排队一个个来。

同步：合作关系，速度有差异，一定情况停下等待。

临界资源：同一时刻，只能有一个进程访问的资源。

**PV 操作**

临界区：每个进程中访问临界资源的代码成为临界区。

信号量：特殊的变量，是一个计数器，代表资源的数量
- 互斥信号量
- 同步信号量

PV 操作：解决互斥和同步的问题，PV 操作分开来看：
- P 操作（申请资源），使得 S=S-1，若S >= 0，进程继续执行，否则该进程进入等待序列
- V 操作（释放资源），使得 S=S+1，若S <= 0，唤醒等待队列中的一个进程

> 互斥模型：
```bash
# 多个进程共享一台打印机模型
# 互斥信号量 S 的初值为 1
P(S):
  使用打印机;
V(S):
  后续代码;
```

> 同步模型
```bash
# 单缓冲区生产者、消费者问题
# S1 初值为 1, S2 初值为 0
生产者:
  生产一个产品
  P(S1)
  送产品到缓冲区
  V(S2)
消费者:
  P(S2)
  从缓冲区取产品
  V(S1)
  消费产品
```

## 存储管理 ⭐
存储方式：
- 区域存储：连续空间的存储
- 页式存储，不连续
  - 优点：利用率高，碎片小，分配及管理简单
  - 缺点：增加系统开销，可能产生抖动现象
- 段式存储，不连续
- 段页式存储

页式存储：

逻辑地址包括页号和页内地址。
- 页号位数，代表地址空间最多有多少页；页号值代表第几页；
- 页内地址位数代表页大小，页内地址值代表页的偏移。

物理地址 = 块号 + 页内地址

页面置换算法：
- 先进先出 FIFO
- 最佳置换 OPT，往后看，看将要使用哪些，置换掉不使用的
- 最近最少使用置换法 LRU

所有内存块最初都是空的，反第一次用到的页面都产生一次缺页。

## 文件管理 ⭐⭐
树形目录结构

绝对路径

相对路径

## 作业管理 ⭐
基本不考，不讲

## 设备管理 ⭐⭐

数据传输控制方式：
- 程序控制方式
  - CPU 检测设备是否可用
  - 串行工作方式
- 程序中断方式
  - CPU 收到中断请求时，保存上下文，去处理中断请求，之后再返回继续工作
  - 中断向量，中断程序的入口地址
  - 中断时要现场保护
- DMA方式
  - 直接存储访问方式
  - 通过硬件直接进行数据传输，不需要 CPU 干预
  - 在一个总线周期过后，CPU 会下发控制权给DMAC控制器
- I/O 通道
  - 需要的 CPU 干预比 DMA 还少